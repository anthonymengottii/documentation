---
title: "Cupons de Desconto"
description: "Sistema completo de cupons com desconto fixo ou percentual. Configure limites de uso, validade e produtos aplic√°veis"
---

## Vis√£o geral

O sistema de **Cupons de Desconto** permite que voc√™ crie e gerencie cupons promocionais que podem ser aplicados durante o checkout. Os cupons suportam descontos percentuais ou valores fixos, com configura√ß√µes flex√≠veis de validade e limites de uso.

## Pr√©-requisitos

Antes de come√ßar, voc√™ precisa:
- Uma conta ativa na UPay
- Sua API Key configurada (veja [Autentica√ß√£o](/pages/authentication))
- Conhecimento b√°sico de APIs REST

## Funcionalidades

- **Tipos de desconto**: Percentual (%) ou valor fixo (R$)
- **Validade configur√°vel**: Data de in√≠cio e fim no formato ISO 8601
- **Limites de uso**: Total de usos e por usu√°rio (null = ilimitado)
- **Valor m√≠nimo**: Defina valor m√≠nimo de compra em centavos
- **Valor m√°ximo**: Limite o desconto m√°ximo em centavos (apenas para percentuais)
- **Produtos espec√≠ficos**: Aplique a todos os produtos ou apenas produtos selecionados
- **Valida√ß√£o p√∫blica**: Endpoint p√∫blico (sem autentica√ß√£o) para validar cupons no checkout

## Criando um cupom

### Requisi√ß√£o B√°sica - Desconto Percentual

```bash
curl -X POST "https://upay-sistema-api.onrender.com/api/v1/coupons" \
  -H "Authorization: Bearer SUA_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "code": "DESCONTO10",
    "discountType": "PERCENTAGE",
    "discountValue": 10,
    "description": "10% de desconto em qualquer compra"
  }'
```

### Requisi√ß√£o - Desconto Fixo

```bash
curl -X POST "https://upay-sistema-api.onrender.com/api/v1/coupons" \
  -H "Authorization: Bearer SUA_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "code": "R$50OFF",
    "discountType": "FIXED",
    "discountValue": 5000,
    "description": "R$ 50,00 de desconto"
  }'
```

### Resposta

```json
{
  "success": true,
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "code": "DESCONTO10",
    "discountType": "PERCENTAGE",
    "discountValue": 10,
    "description": "10% de desconto em qualquer compra",
    "minPurchaseAmount": null,
    "maxDiscountAmount": null,
    "maxUses": null,
    "maxUsesPerUser": null,
    "validFrom": null,
    "validUntil": null,
    "productIds": [],
    "status": "ACTIVE",
    "usedCount": 0,
    "createdAt": "2025-12-30T00:00:00.000Z"
  }
}
```

## Campos dispon√≠veis

### Campos obrigat√≥rios

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `code` | string | C√≥digo √∫nico do cupom. M√°ximo 50 caracteres. Apenas letras, n√∫meros e h√≠fen. |
| `discountType` | string | Tipo de desconto. Valores: "PERCENTAGE" ou "FIXED". |
| `discountValue` | number | Valor do desconto. Para PERCENTAGE: valor percentual (ex: 10 = 10%). Para FIXED: valor em centavos (ex: 5000 = R$ 50,00). M√≠nimo: 1. |

### Campos opcionais

| Campo | Tipo | Descri√ß√£o | Padr√£o |
|-------|------|-----------|--------|
| `description` | string | Descri√ß√£o do cupom. M√°ximo 500 caracteres. | - |
| `minPurchaseAmount` | number | Valor m√≠nimo de compra em centavos. M√≠nimo: 0. | null |
| `maxDiscountAmount` | number | Valor m√°ximo de desconto em centavos. Apenas para PERCENTAGE. M√≠nimo: 1. | null |
| `maxUses` | number | Limite total de usos do cupom. null = ilimitado. M√≠nimo: 1. | null |
| `maxUsesPerUser` | number | Limite de usos por usu√°rio. null = ilimitado. M√≠nimo: 1. | null |
| `validFrom` | string | Data de in√≠cio da validade. Formato ISO 8601. Exemplo: "2024-01-01T00:00:00Z". | null |
| `validUntil` | string | Data de fim da validade. Formato ISO 8601. Deve ser posterior a `validFrom`. | null |
| `productIds` | array | Array de IDs de produtos aplic√°veis. Vazio ou null = todos os produtos. | [] |
| `status` | string | Status do cupom. Valores: "ACTIVE" ou "INACTIVE". | "ACTIVE" |

## üìñ Exemplos Completos

### Cupom Simples - 10% de Desconto

```javascript
const response = await fetch('https://upay-sistema-api.onrender.com/api/v1/coupons', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    code: 'PROMO10',
    discountType: 'PERCENTAGE',
    discountValue: 10,
    description: '10% de desconto em qualquer compra'
  })
});
```

### Cupom com Validade e Limites

```javascript
const validFrom = new Date();
const validUntil = new Date();
validUntil.setDate(validUntil.getDate() + 30); // V√°lido por 30 dias

const response = await fetch('https://upay-sistema-api.onrender.com/api/v1/coupons', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    code: 'BLACKFRIDAY',
    discountType: 'PERCENTAGE',
    discountValue: 25,
    description: 'Black Friday - 25% de desconto',
    minPurchaseAmount: 10000, // M√≠nimo R$ 100,00
    maxDiscountAmount: 50000, // M√°ximo R$ 500,00 de desconto
    maxUses: 1000, // M√°ximo 1000 usos totais
    maxUsesPerUser: 1, // 1 uso por usu√°rio
    validFrom: validFrom.toISOString(),
    validUntil: validUntil.toISOString()
  })
});
```

### Cupom para Produtos Espec√≠ficos

```javascript
const response = await fetch('https://upay-sistema-api.onrender.com/api/v1/coupons', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    code: 'PRODUTOESPECIAL',
    discountType: 'FIXED',
    discountValue: 2000, // R$ 20,00 de desconto
    description: 'R$ 20,00 de desconto em produtos selecionados',
    productIds: [
      'produto-1-id',
      'produto-2-id'
    ]
  })
});
```

## Validando um cupom

### Endpoint P√∫blico (Checkout)

O endpoint de valida√ß√£o √© **p√∫blico** e n√£o requer autentica√ß√£o. Use-o no checkout para validar cupons:

```bash
curl -X POST "https://upay-sistema-api.onrender.com/api/v1/coupons/validate" \
  -H "Content-Type: application/json" \
  -d '{
    "code": "DESCONTO10",
    "amount": 10000
  }'
```

### Resposta - Cupom V√°lido

```json
{
  "success": true,
  "valid": true,
  "data": {
    "code": "DESCONTO10",
    "discountType": "PERCENTAGE",
    "discountValue": 10,
    "discountAmount": 1000,
    "finalAmount": 9000,
    "description": "10% de desconto em qualquer compra"
  }
}
```

### Resposta - Cupom Inv√°lido

```json
{
  "success": false,
  "valid": false,
  "message": "Cupom n√£o encontrado ou inv√°lido"
}
```

### Exemplo em JavaScript (Checkout)

```javascript
async function validateCoupon(code, amount) {
  const response = await fetch('https://upay-sistema-api.onrender.com/api/v1/coupons/validate', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      code: code,
      amount: amount // Valor em centavos
    })
  });
  
  const data = await response.json();
  
  if (data.valid) {
    console.log(`Desconto: R$ ${(data.data.discountAmount / 100).toFixed(2)}`);
    console.log(`Valor final: R$ ${(data.data.finalAmount / 100).toFixed(2)}`);
    return data.data;
  } else {
    console.error(data.message);
    return null;
  }
}
```

## üîç Listando Cupons

### Listar Todos os Cupons

```bash
curl -X GET "https://upay-sistema-api.onrender.com/api/v1/coupons?page=1&limit=20" \
  -H "Authorization: Bearer SUA_API_KEY"
```

### Buscar Cupom Espec√≠fico

```bash
curl -X GET "https://upay-sistema-api.onrender.com/api/v1/coupons/{id}" \
  -H "Authorization: Bearer SUA_API_KEY"
```

## Atualizando um cupom

```bash
curl -X PATCH "https://upay-sistema-api.onrender.com/api/v1/coupons/{id}" \
  -H "Authorization: Bearer SUA_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "status": "INACTIVE",
    "maxUses": 500
  }'
```

<Note>
  Voc√™ pode atualizar apenas os campos que desejar. Campos n√£o enviados permanecer√£o inalterados.
</Note>

## üóëÔ∏è Deletando um Cupom

```bash
curl -X DELETE "https://https://upay-sistema-api.onrender.com//api/v1/coupons/{id}" \
  -H "Authorization: Bearer SUA_API_KEY"
```

<Warning>
  A exclus√£o √© permanente. Cupons j√° utilizados mant√™m o hist√≥rico de uso.
</Warning>

## Regras de valida√ß√£o

O sistema valida automaticamente:

1. **C√≥digo v√°lido**: O cupom existe e est√° ativo
2. **Validade**: Data atual est√° entre `validFrom` e `validUntil`
3. **Limites de uso**: N√£o excedeu `maxUses` e `maxUsesPerUser`
4. **Valor m√≠nimo**: Compra atinge `minPurchaseAmount`
5. **Produtos aplic√°veis**: Produto est√° na lista `productIds` (se especificado)
6. **Desconto m√°ximo**: Para percentuais, respeita `maxDiscountAmount`

## üéØ Casos de Uso

### Promo√ß√µes Tempor√°rias
Crie cupons com validade limitada para campanhas espec√≠ficas.

### Descontos por Volume
Configure valor m√≠nimo de compra para incentivar compras maiores.

### Cupons Exclusivos
Use limites de uso para criar cupons exclusivos ou limitados.

### Produtos Espec√≠ficos
Aplique descontos apenas a produtos selecionados do cat√°logo.

### Primeira Compra
Configure `maxUsesPerUser: 1` para cupons de primeira compra.

## Pr√≥ximos passos

<CardGroup cols={2}>
  <Card title="Refer√™ncia da API" icon="code" href="/pages/coupon/reference">
    Veja todos os endpoints dispon√≠veis
  </Card>
  <Card title="Links de Pagamento" icon="link" href="/pages/guides/features/payment-links">
    Integre cupons no checkout
  </Card>
</CardGroup>

