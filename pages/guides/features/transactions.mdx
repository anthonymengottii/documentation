---
title: "Transa√ß√µes"
description: "Gerencie e consulte transa√ß√µes de pagamento com PIX, cart√£o e boleto. Acompanhe status, hist√≥rico e detalhes completos"
---

## Vis√£o geral

As **Transa√ß√µes** representam todas as opera√ß√µes de pagamento realizadas atrav√©s da Upay Gateway API. Cada transa√ß√£o cont√©m informa√ß√µes completas sobre o pagamento, incluindo m√©todo utilizado, status, valores e dados do cliente.

## Pr√©-requisitos

Antes de come√ßar, voc√™ precisa:
- Uma conta ativa na Upay
- Sua API Key configurada (veja [Autentica√ß√£o](/authentication))
- Conhecimento b√°sico de APIs REST

## Funcionalidades

- **M√∫ltiplos m√©todos de pagamento**: PIX, Cart√£o de Cr√©dito/D√©bito, Boleto
- **Rastreamento em tempo real**: Acompanhe o status de cada transa√ß√£o
- **Hist√≥rico completo**: Consulte todas as transa√ß√µes com pagina√ß√£o
- **Detalhes do cliente**: Informa√ß√µes completas do pagador
- **Webhooks**: Receba notifica√ß√µes autom√°ticas de mudan√ßas de status
- **Filtros avan√ßados**: Busque por status, m√©todo de pagamento, per√≠odo e mais

## Criando uma transa√ß√£o

### Requisi√ß√£o B√°sica - PIX

```bash
curl -X POST "https://upay-sistema-api.onrender.com/api/v1/transactions" \
  -H "Authorization: Bearer SUA_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "paymentLinkId": "550e8400-e29b-41d4-a716-446655440000",
    "paymentMethod": "PIX",
    "amountCents": 9900,
    "client": {
      "name": "Jo√£o Silva",
      "email": "joao@example.com",
      "phone": "+5511999999999",
      "document": "12345678900"
    }
  }'
```

### Resposta

```json
{
  "success": true,
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "displayId": "TRX-2025-001234",
    "paymentLinkId": "550e8400-e29b-41d4-a716-446655440001",
    "amountCents": 9900,
    "amount": 99.00,
    "currency": "BRL",
    "paymentMethod": "PIX",
    "status": "PENDING",
    "pixQrCode": "00020126580014br.gov.bcb.pix...",
    "pixQrCodeUrl": "https://api.qrserver.com/v1/create-qr-code/?data=...",
    "pixExpiresAt": "2025-12-30T01:00:00.000Z",
    "client": {
      "id": "550e8400-e29b-41d4-a716-446655440002",
      "name": "Jo√£o Silva",
      "email": "joao@example.com",
      "phone": "+5511999999999",
      "document": "12345678900"
    },
    "createdAt": "2025-12-30T00:00:00.000Z",
    "updatedAt": "2025-12-30T00:00:00.000Z"
  }
}
```

## Campos dispon√≠veis

### Campos obrigat√≥rios

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `paymentLinkId` | string | ID do link de pagamento associado. UUID v√°lido. |
| `paymentMethod` | string | M√©todo de pagamento. Valores: "PIX", "CREDIT_CARD", "DEBIT_CARD", "BOLETO". |
| `amountCents` | number | Valor em centavos. Exemplo: 9900 = R$ 99,00. M√≠nimo: 100 (R$ 1,00). |
| `client` | object | Dados do cliente (veja abaixo). |

### Dados do cliente (`client`)

| Campo | Tipo | Descri√ß√£o | Obrigat√≥rio |
|-------|------|-----------|-------------|
| `name` | string | Nome completo do cliente. M√°ximo 255 caracteres. | Sim |
| `email` | string | Email v√°lido do cliente. | Sim |
| `phone` | string | Telefone com c√≥digo do pa√≠s. Formato: +5511999999999. | Sim |
| `document` | string | CPF ou CNPJ (apenas n√∫meros). | Sim |
| `address` | object | Endere√ßo completo (obrigat√≥rio para boleto). | Condicional |

### Endere√ßo (`address`)

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `street` | string | Logradouro. |
| `number` | string | N√∫mero. |
| `complement` | string | Complemento (opcional). |
| `neighborhood` | string | Bairro. |
| `city` | string | Cidade. |
| `state` | string | Estado (UF). |
| `zipCode` | string | CEP (apenas n√∫meros). |

### Campos opcionais

| Campo | Tipo | Descri√ß√£o | Padr√£o |
|-------|------|-----------|--------|
| `currency` | string | C√≥digo da moeda. Atualmente apenas "BRL". | "BRL" |
| `installments` | number | N√∫mero de parcelas (apenas cart√£o de cr√©dito). M√≠nimo: 1, M√°ximo: 12. | 1 |
| `metadata` | object | Dados adicionais personalizados. | {} |

## üìñ Exemplos Completos

### Transa√ß√£o com Cart√£o de Cr√©dito

```javascript
const response = await fetch('https://upay-sistema-api.onrender.com/api/v1/transactions', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    paymentLinkId: 'link-id-aqui',
    paymentMethod: 'CREDIT_CARD',
    amountCents: 19900, // R$ 199,00
    installments: 3,
    client: {
      name: 'Maria Santos',
      email: 'maria@example.com',
      phone: '+5511988888888',
      document: '98765432100'
    },
    card: {
      number: '4111111111111111',
      holderName: 'MARIA SANTOS',
      expiryMonth: '12',
      expiryYear: '2028',
      cvv: '123'
    }
  })
});
```

### Transa√ß√£o com Boleto

```javascript
const response = await fetch('https://upay-sistema-api.onrender.com/api/v1/transactions', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    paymentLinkId: 'link-id-aqui',
    paymentMethod: 'BOLETO',
    amountCents: 29900, // R$ 299,00
    client: {
      name: 'Pedro Oliveira',
      email: 'pedro@example.com',
      phone: '+5511977777777',
      document: '12345678900',
      address: {
        street: 'Rua das Flores',
        number: '123',
        complement: 'Apto 45',
        neighborhood: 'Centro',
        city: 'S√£o Paulo',
        state: 'SP',
        zipCode: '01310100'
      }
    }
  })
});
```

### Transa√ß√£o com Metadata

```javascript
const response = await fetch('https://upay-sistema-api.onrender.com/api/v1/transactions', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    paymentLinkId: 'link-id-aqui',
    paymentMethod: 'PIX',
    amountCents: 9900,
    client: {
      name: 'Ana Costa',
      email: 'ana@example.com',
      phone: '+5511966666666',
      document: '11122233344'
    },
    metadata: {
      orderId: 'ORD-2025-001',
      customerId: 'CUST-123',
      source: 'website',
      campaign: 'black-friday'
    }
  })
});
```

## Consultando transa√ß√µes

### Listar Todas as Transa√ß√µes

```bash
curl -X GET "https://upay-sistema-api.onrender.com/api/v1/transactions?page=1&limit=20" \
  -H "Authorization: Bearer SUA_API_KEY"
```

### Resposta

```json
{
  "success": true,
  "data": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "displayId": "TRX-2025-001234",
      "amountCents": 9900,
      "amount": 99.00,
      "currency": "BRL",
      "paymentMethod": "PIX",
      "status": "COMPLETED",
      "client": {
        "name": "Jo√£o Silva",
        "email": "joao@example.com"
      },
      "createdAt": "2025-12-30T00:00:00.000Z"
    }
  ],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 150,
    "totalPages": 8
  }
}
```

### Buscar Transa√ß√£o Espec√≠fica

```bash
curl -X GET "https://upay-sistema-api.onrender.com/api/v1/transactions/{id}" \
  -H "Authorization: Bearer SUA_API_KEY"
```

### Filtros Dispon√≠veis

```bash
# Filtrar por status
curl -X GET "https://upay-sistema-api.onrender.com/api/v1/transactions?status=COMPLETED" \
  -H "Authorization: Bearer SUA_API_KEY"

# Filtrar por m√©todo de pagamento
curl -X GET "https://upay-sistema-api.onrender.com/api/v1/transactions?paymentMethod=PIX" \
  -H "Authorization: Bearer SUA_API_KEY"

# Filtrar por per√≠odo
curl -X GET "https://upay-sistema-api.onrender.com/api/v1/transactions?startDate=2025-01-01&endDate=2025-12-31" \
  -H "Authorization: Bearer SUA_API_KEY"

# Combinar filtros
curl -X GET "https://upay-sistema-api.onrender.com/api/v1/transactions?status=COMPLETED&paymentMethod=PIX&page=1&limit=50" \
  -H "Authorization: Bearer SUA_API_KEY"
```

## üìä Status da Transa√ß√£o

| Status | Descri√ß√£o | A√ß√£o |
|--------|-----------|------|
| `PENDING` | Aguardando pagamento | Aguardar confirma√ß√£o |
| `PROCESSING` | Processando pagamento | Aguardar processamento |
| `COMPLETED` | Pagamento confirmado | Liberar produto/servi√ßo |
| `FAILED` | Pagamento falhou | Tentar novamente |
| `CANCELLED` | Transa√ß√£o cancelada | Criar nova transa√ß√£o |
| `REFUNDED` | Pagamento reembolsado | Registrar reembolso |
| `EXPIRED` | Transa√ß√£o expirada | Criar nova transa√ß√£o |

## M√©todos de pagamento

### PIX

- **Tempo de expira√ß√£o**: 30 minutos (padr√£o)
- **Confirma√ß√£o**: Instant√¢nea
- **Retorno**: QR Code e c√≥digo copia-e-cola
- **Webhook**: `payment.completed` quando confirmado

```json
{
  "pixQrCode": "00020126580014br.gov.bcb.pix...",
  "pixQrCodeUrl": "https://api.qrserver.com/v1/create-qr-code/?data=...",
  "pixExpiresAt": "2025-12-30T01:00:00.000Z"
}
```

### Cart√£o de Cr√©dito

- **Parcelamento**: At√© 12x
- **Confirma√ß√£o**: Imediata ou em at√© 2 dias √∫teis
- **Retorno**: Status da autoriza√ß√£o
- **Webhook**: `payment.completed` ou `payment.failed`

### Cart√£o de D√©bito

- **Parcelamento**: N√£o dispon√≠vel
- **Confirma√ß√£o**: Imediata
- **Retorno**: Status da autoriza√ß√£o
- **Webhook**: `payment.completed` ou `payment.failed`

### Boleto

- **Vencimento**: 3 dias √∫teis (padr√£o)
- **Confirma√ß√£o**: 1-3 dias √∫teis ap√≥s pagamento
- **Retorno**: URL do boleto e c√≥digo de barras
- **Webhook**: `payment.completed` quando compensado

```json
{
  "boletoUrl": "https://boleto.upaybr.com/...",
  "boletoBarcode": "34191.79001 01043.510047 91020.150008 1 84350000002000",
  "boletoExpiresAt": "2025-01-02T23:59:59.000Z"
}
```

## üîî Webhooks

Configure webhooks para receber notifica√ß√µes autom√°ticas sobre mudan√ßas de status:

```javascript
// Eventos dispon√≠veis
const events = [
  'payment.completed',   // Pagamento confirmado
  'payment.failed',      // Pagamento falhou
  'payment.pending',     // Pagamento pendente
  'payment.refunded',    // Pagamento reembolsado
  'payment.cancelled'    // Pagamento cancelado
];
```

Veja o [guia completo de webhooks](/guides/features/webhooks) para mais detalhes.

## Seguran√ßa

### Valida√ß√£o de Dados

Sempre valide os dados antes de criar uma transa√ß√£o:

```javascript
function validateTransaction(data) {
  // Validar valor m√≠nimo
  if (data.amountCents < 100) {
    throw new Error('Valor m√≠nimo: R$ 1,00');
  }
  
  // Validar email
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!emailRegex.test(data.client.email)) {
    throw new Error('Email inv√°lido');
  }
  
  // Validar CPF/CNPJ
  if (!isValidDocument(data.client.document)) {
    throw new Error('CPF/CNPJ inv√°lido');
  }
  
  return true;
}
```

### Prote√ß√£o contra Duplicatas

Use `metadata` para rastrear transa√ß√µes e evitar duplicatas:

```javascript
const transaction = await upay.transactions.create({
  // ... outros campos
  metadata: {
    orderId: 'ORD-2025-001',
    idempotencyKey: generateUniqueKey()
  }
});
```

## Boas pr√°ticas

1. **Sempre use webhooks**: N√£o confie apenas em polling para verificar status
2. **Armazene o ID da transa√ß√£o**: Guarde o `id` e `displayId` no seu banco de dados
3. **Trate erros adequadamente**: Implemente retry com backoff exponencial
4. **Valide dados do cliente**: Verifique CPF/CNPJ, email e telefone antes de enviar
5. **Use metadata**: Armazene informa√ß√µes adicionais para rastreamento
6. **Monitore expira√ß√£o**: PIX expira em 30 minutos, boleto em 3 dias
7. **Implemente timeout**: Configure timeout adequado nas requisi√ß√µes

## Casos de uso

### E-commerce
Processe pagamentos de produtos com m√∫ltiplos m√©todos e parcelamento.

### Assinaturas
Crie transa√ß√µes recorrentes para cobran√ßas mensais.

### Marketplace
Gerencie transa√ß√µes entre m√∫ltiplos vendedores.

### Doa√ß√µes
Aceite doa√ß√µes via PIX com confirma√ß√£o instant√¢nea.

### Servi√ßos
Cobre por servi√ßos prestados com boleto ou cart√£o.

## üìö Pr√≥ximos Passos

<CardGroup cols={2}>
  <Card title="Refer√™ncia da API" icon="code" href="/pages/transactions/reference">
    Veja todos os endpoints dispon√≠veis
  </Card>
  <Card title="Links de pagamento" icon="link" href="/guides/features/payment-links">
    Crie links para receber pagamentos
  </Card>
  <Card title="Webhooks" icon="bell" href="/guides/features/webhooks">
    Configure notifica√ß√µes em tempo real
  </Card>
  <Card title="Tratamento de Erros" icon="triangle-alert" href="/troubleshooting">
    Entenda os c√≥digos de erro
  </Card>
</CardGroup>
